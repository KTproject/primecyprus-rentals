<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prime Cyprus Rentals</title>
  <!-- Your existing CSS links or styles here -->
</head>
<body>
  <!-- Your existing nav/header here -->

  <!-- Hero section with carousel - keep your existing or add photos -->
  <section class="hero">
    <!-- Your hero carousel or background here -->
    <h1>Discover Premium Rentals in Cyprus</h1>
    <p>Luxury villas, seafront apartments, and long-term homes — short stays or extended bases in Limassol, Paphos, and beyond.</p>
  </section>

  <!-- Your search bar here (keep as is) -->
  <div class="search-bar">
    <!-- Your location, type, dates, guests, etc. inputs -->
    <button>Search Rentals →</button>
  </div>

  <section class="listings-section" id="listings">
    <div class="container">
      <div class="listings-header">
        <div>
          <span class="section-label">Available Now</span>
          <h2>Featured Rentals</h2>
        </div>
        <div class="listings-count">Showing <span id="listingCount">0</span> properties</div>
      </div>

      <div class="listings-grid" id="listingsGrid">
        <!-- Rentals from Sanity will load here -->
      </div>
    </div>
  </section>

  <!-- Your existing footer or other sections here -->

  <script type="module">
    import { client } from './lib/sanity.ts'

    console.log('Script loaded - Sanity client:', client);

    async function loadRentals() {
      console.log('Fetching rentals from Sanity...');

      const query = `*[_type == "rental"] | order(_createdAt desc) [0..5] {
        title,
        location,
        priceMonthly,
        "imageUrl": images[0].asset->url,
        description
      }`

      try {
        const rentals = await client.fetch(query);
        console.log('Fetched rentals:', rentals);

        const count = document.getElementById('listingCount');
        if (count) count.textContent = rentals.length;

        const grid = document.getElementById('listingsGrid');
        if (grid) {
          grid.innerHTML = rentals.map(r => `
            <div class="rental-card animate-in">
              <div class="rental-card__body">
                <div class="rental-card__location">${r.location || 'Location TBD'}</div>
                <div class="rental-card__title">${r.title || 'No title'}</div>
                <div class="rental-card__desc">${r.description ? r.description.substring(0, 100) + '...' : 'No description'}</div>
                <div class="rental-card__footer">
                  <div class="rental-card__price">€${r.priceMonthly || 'N/A'} <span class="rental-card__price-period">/month</span></div>
                  <a href="https://primecyprus.xyz/contact.html" class="rental-card__cta">Enquire →</a>
                </div>
              </div>
            </div>
          `).join('');
          console.log('Rendered', rentals.length, 'rentals');
        } else {
          console.error('No #listingsGrid container found');
        }
      } catch (err) {
        console.error('Sanity fetch error:', err);
      }
    }

    loadRentals();
  </script>

</body>
</html>